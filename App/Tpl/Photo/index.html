<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <!--<style type="text/css">
        body {
            background: #edeeef url("//instagramstatic-a.akamaihd.net/bluebar/727396f/images/shared/noise-2.png");
        }

        a, a:visited {
            color: #3f729b;
            text-decoration: none;
        }

        .timelineBookmarkInfo {
            padding: 0 52px 0 0;
        }

        .timelineBookmarkInfoUsername {
            overflow: hidden;
            -webkit-text-overflow: ellipsis;
            white-space: nowrap;
            padding-left: 4px;
        }

        .wrapper {
            max-width: 1024px;
            padding-bottom: 52px;
            text-align: center;
            margin: 0 auto;
            position: relative;
            width: 992px;
        }

        .timelineSider, .timelineCenter {
            padding-top: 32px;
        }

        .timelineSider {
            float: left;
            width: 224px padding : 16 px 0;
        }

        .timelineCenter {
            box-shadow: inset 1px 0 0 rgba(0, 0, 0, .05), inset -1px 0 0 rgba(0, 0, 0, .05);
            background: #e0e1e2 url("//instagramstatic-a.akamaihd.net/bluebar/727396f/images/shared/noise-2.png");
            border: 1px solid rgba(0, 0, 0, .1);
            border-width: 0 1px;
            min-width: 240px;
            max-width: 512px;
            padding: 16px 32px;
            margin-left: 224px;
            padding-top: 32px;
        }

        .timelineCard {
            background: #fafafa;
            border: 1px solid silver;
            border-radius: 3px;
            box-shadow: 0 1px 16px rgba(0, 0, 0, .1);
        }

        .timelineCard .mediaPhoto .i-like-big {
            display: block;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: url("//instagramstatic-a.akamaihd.net/bluebar/5021840/images/p/glyph-heart-pop-big.png") no-repeat 50% 50%;
            z-index: 100;
            background-size: 40% 40%;
            opacity: 0;
            pointer-events: none;
        }

        .Image {
            overflow: hidden;
            position: relative;
            display: block;
        }

        .Image::before {
            content: '';
            display: block;
            padding-bottom: 100%;
        }

        .iImage {
            background-size: 100% 100%;
            bottom: 0;
            left: 0;
            position: absolute;
            right: 0;
            top: 0;
        }

        .timelineBookmark {
            font-weight: 700;
            text-shadow: 0 1px 0 rgba(255, 255, 255, .8);
            line-height: 16px;
            margin-right: 24px;
            padding-top: 4px;
            position: relative;
        }

        .header {
            height: 60px;
            /*margin-bottom: 20px; */
            margin-left: -15px;
            margin-right: -15px;
            border-bottom: 1px solid #1c5380;
            border-bottom-color: rgba(4, 40, 71, .8);
            background-color: #517fa4;
            box-shadow: 0 1px 0 rgba(111, 151, 182, .5) inset, 0 -1px 0 rgba(111, 151, 182, .2) inset, 0 1px 1px rgba(0, 0, 0, .2);
            background-image: url("//instagramstatic-a.akamaihd.net/bluebar/f688a03/images/shared/noise-1.png"), -webkit-linear-gradient(top, #517fa4, #306088);
            z-index: 100;
        }

        .timelineLikes {
            background: url("//instagramstatic-a.akamaihd.net/bluebar/58d7454/images/bg/white-gradient-100px.png") repeat-x scroll 50% 50% #e6e6e6;
            border-bottom: 1px solid #ddd;
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 0 3px rgba(0, 0, 0, 0.1);
            height: 40px;
            margin: 1px 0 -1px;
            position: relative;
        }

        .timelineLikeButton {
            -moz-user-select: none;
            background: url("//instagramstatic-a.akamaihd.net/bluebar/58d7454/images/feed/feed-assets.png") no-repeat scroll 8px 6px rgba(0, 0, 0, 0);
            border-right: 1px solid #ddd;
            box-shadow: 1px 0 0 rgba(255, 255, 255, 0.9);
            display: inline;
            float: left;
            height: 100%;
            position: relative;
            width: 48px;
        }

        .timelineLikeList {
            line-height: 16px;
            margin: 0 52px 0 48px;
            overflow: hidden;
            padding: 12px 0 12px 12px;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .mediaMoreButtonContainer {
            float: right;
            margin-right: 1px;
        }

        .mediaMoreButtonContainer {
            display: inline;
            height: 100%;
            position: relative;
            width: 48px;
        }

        .timelineLikes
        .mediaMoreButton {
            border-left: 1px solid #ddd;
            box-shadow: inset 1px 0 0 rgba(255, 255, 255, .9);
        }

        .mediaMoreButton {
            background: url("//instagramstatic-a.akamaihd.net/bluebar/5021840/images/feed/feed-assets.png") no-repeat 7px -94px;
            display: block;
            height: 100%;
        }

        .timelineComments {
            padding: 0;
        }

        .timelineCommentForm:focus{
            border-color: #66afe9;
        }
        .timelineCaption.timelineComment {
            border-bottom: 1px solid #e6e6e6;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
            margin-bottom: 0;
            padding: 12px 12px 11px 48px;
            word-wrap: break-word;
        }

        .timelineComment {
            text-overflow: ellipsis;
            transition: opacity 0.2s ease 0s;
        }

        .timelineCommentComposer {
            margin-bottom: 0;
            padding: 12px;
        }

        .timelineComment, .timelineCommentMore, .timelineCommentComposer {
            position: relative;
        }

        .timelineCommentTextField {
            border-color: #d8d8d8;
            border-radius: 2px;
            margin: 0;
            padding: 8px 9px 7px;
            width: 100%;
        }

        .fadedTextField {
            background-color: rgba(255, 255, 255, 0.2);
            border-color: rgba(0, 0, 0, 0.08);
        }

        button, input, select {
            vertical-align: baseline;
        }

        div {
            display: block;
        }
    </style>-->
    <style>
        .addfileA {
            cursor: hand;
            text-decoration: none;
            width: 116px;
            height: 38px;
            background-color: #579BD3;
            display: block;
            border: 1px solid rgba(160, 200, 232, 0.26);
            border-radius: 4px;
            margin-bottom: 5px;
            margin-top: 5px;
        }

        .addfileI {
            cursor: hand;
            position: relative;
            left: 0px;
            width: 116px;
            height: 38px;
            background-color: #1c5380;
            opacity: 0;
            filter: alpha(opacity=0);
            border-radius: 4px;
        }
    </style>
    <link rel="stylesheet" href="__PUBLIC__/CSS/user.css"/>
    <link rel="shortcut icon" href="__PUBLIC__/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="__PUBLIC__/img/favicon.ico" type="image/x-icon">
    <title>Memory</title>
</head>
<body class="timelineFeedPage">
<span id="react-root">
        <div class="root">
            <div class="page">
                <header class="top-bar top-bar-new">
                    <div class="top-bar-wrapper">
                        <div class="logo">
                            <a href="__APP__">Amber</a>
                        </div>
                        <div class="top-bar-left">
                            <ul class="top-bar-actions">
                                <li>
                                    <a class="link-active top-bar-home" title="首页" href="__APP__"><i></i></a>
                                </li>
                            </ul>
                        </div>
                        <div class="top-bar-right account-state" id="top_var_right">
                            <ul class="top-bar-actions">
                                <li class="link-profile">
                                    <a href="javacript:;" id="_dropdownContext0">
                                    <span class="img img-outset current-user-avatar"
                                          style="background-image: url(http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg);">
                                        <img src="http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg"
                                             alt=""/>
                                        <b></b>
                                    </span>
                                        <strong>{$username}</strong>
                                    </a>
                                    <span></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </header>
                <div class="main">
                    <div class="wrapper">
                        <div class="timelineContainer">
                            <div class="row">
                                <div class="col-md-2"></div>
                                <div class="col-md-8">
                                    <form class="form-inline" action="__URL__/index" method="post"
                                          enctype="multipart/form-data">
                                        <div class="form-group col-sm-8">
                                            <label class="sr-only" for="feeling">想法</label>
                                            <input id="feeling" type="text" name="feelings"/ style="width:380px;
                                            margin-top:
                                            5px; margin-bottom:5px; margin-left:40px;">
                                        </div>
                                        <div class="form-group col-sm-4">
                                            <!-- <label class="sr-only" for="imageUpload">图片文件</label> -->
                                            <a href="#" class="addfileA">
                                                <input class="addfileI" id="imageUpload" type="file" name="files[]"/>
                                            </a>
                                        </div>
                                        <!-- <div class="form-group">
                                            <label class="sr-only" for="uploadbtn">上传</label>
                                            <input id="uploadbtn" name="" value="上传" type="submit"/>
                                        </div> -->
                                    </form>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <volist name="photo_array" id="vo">
                                <div class="timelineItem" data-user-id="{$vo.pid}">
                                    <div class="timelineSidebar">
                                        <div class="timelineBookmark">
                                            <div class="timelineBookmarkFirstRow">
                                                <div class="timelineBookmarkInfo">
                                                    <a class="timelineBookmarkInfoUsername"
                                                       href="__URL__/user/uid/{$vo.uid}">
                                                        {$vo.name}
                                                    </a>
                                                    <span class="timelineBookmarkInfoTimestamp">
                                                        <span class="timelineBookmarkInfoTimestampContent">
                                                            {$vo.elapse}
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="timelineCenter">
                                        <div class="timelineCard">
                                            <div class="mediaPhoto">
                                                <span class="i-like-big"></span>

                                                <div src="{$vo.path}{$vo.pname}" class="mpFrame Frame Image">
                                                    <div>
                                                        <div class="iImage" id="iImage"
                                                             style="background-image: url({$vo.path}{$vo.pname});"></div>
                                                    </div>
                                                </div>
                                                <!--<img style="width: 300px; height:300px " src="{$vo.path}{$vo.pname}">-->
                                            </div>
                                            <div class="timelineLikes">
                                                <a class="timelineLikeButton <if condition=" ($vo.islike eq 100)">timelineLiked</if>
                                                " href="javacript:;" title="Toggle like">
                                                <span class="i-like-pop timelineLikeButtonAnimation"></span>
                                                </a>
                                                <div class="mediaMoreButtonContainer">
                                                    <a href="javascript:;" class="mediaMoreButton" title="More"
                                                       role="button"></a>
                                                </div>
                                                <div class="timelineLikeList">
                                                    <if condition="$vo.likes gt 3">
                                                    <span class="LikeList">
                                                        <span></span>
                                                        <volist name="vo['like']" id="sub0" key="k" offset="0"
                                                                length="3">
                                                            <a class="llNameLink" href="/{$sub0.name}/">{$sub0.name}</a>
                                                            <if condition="($k lt 2)">
                                                                <span>, </span>
                                                            </if>
                                                        </volist>
                                                        <span> and </span>
                                                        <span class="llRemainingCount">{$vo.likes}</span>
                                                        <span> others like this.</span>
                                                    </span>
                                                    <elseif condition="$vo.likes gt 1" />
                                                    <span class="LikeList">
                                                        <span></span>
                                                        <volist name="vo['like']" id="sub0" key="k" offset="0"
                                                                length="3">
                                                            <a class="llNameLink" href="/{$sub0.name}/">{$sub0.name}</a>
                                                            <if condition="($k lt 2)">
                                                                <span>, </span>
                                                            </if>
                                                        </volist>
                                                        <span> like this.</span>
                                                    </span>
                                                    <elseif condition="$vo.likes gt 0" />
                                                    <span class="LikeList">
                                                        <span></span>
                                                        <volist name="vo['like']" id="sub0" key="k" offset="0"
                                                                length="3">
                                                            <a class="llNameLink" href="/{$sub0.name}/">{$sub0.name}</a>
                                                        </volist>
                                                        <span> likes this.</span>
                                                    </span>
                                                    <else />
                                                    <span class="noLikes"></span>
                                                    </if>
                                                </div>
                                            </div>
                                            <div class="timelineComments">
                                                <div class="timelineComment timelineCaption">
                                                    <a href="__URL__/{$vo.name}/">
                                                        <div src="http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg"
                                                             class="timelineCommentAvatar Image">
                                                            <div>
                                                                <div class="iImage" id="iImage"
                                                                     style="background-image: url(http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg)">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </a>
                                                    <a class="timelineCommentUsername"
                                                       href="__URL__/{$vo.name}/">{$vo.name}</a>
                                <span class="timelineCommentText">
                                    <span>{$vo.impression}</span>
                                </span>
                                                </div>
                                                <div class="scrollArea scrollAreaOpen scrollAreaInitialized">
                                                    <div class="scrollAreaContents">
                                                        <volist name="vo['comment']" id="sub" offset="0" length="3">
                                                            <div class="timelineComment">
                                                                <a href="/{$sub.name}/">
                                                                    <div class="timelineCommentAvatar Image"
                                                                         src="http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg">
                                                                        <div class="iImage" id="iImage"
                                                                             style="background-image: url(http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg)"></div>
                                                                    </div>
                                                                </a>
                                                                <a href="__URL__/{$sub.name}/"
                                                                   class="timelineCommentUsername">{$sub.name}</a>
	                    					<span class="timelineCommentText">
	                    						<span>{$sub.comment}</span>
	                    					</span>
                                                                <a class="delete-comment"></a>
                                                            </div>
                                                        </volist>
                                                    </div>
                                                </div>
                                                <div class="timelineCommentComposer">
                                                    <div class="timelineCommentAvatar Image"
                                                         style="width: 24px; height: 24px"></div>
                                                    <div class="timelineCommentText">
                                                        <form class="timelineCommentForm"><input type="text"
                                                                                                 class="fadedTextField timelineCommentTextField"
                                                                                                 placeholder="写评论...">
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </volist>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </span>

<div class="DropdownMenu" style="z-index: 100; display: none; position: fixed; left: 1133.5px; top: 22px;">
    <div data-reactid=".3">
        <div class="dWrapper" data-reactid=".3.0">
            <div class="dContainer dRightAlign" data-reactid=".3.0.0">
                <div class="ResponsiveBlock" data-reactid=".3.0.0.0">
                    <div class="Dropdown" data-reactid=".3.0.0.0.0"><i data-reactid=".3.0.0.0.0.0"></i>
                        <ul data-reactid=".3.0.0.0.0.1">
                            <li data-reactid=".3.0.0.0.0.1.0"><a class="modal-catch-focus" href="/nicksxs/"
                                                                 data-reactid=".3.0.0.0.0.1.0.0">View Profile</a></li>
                            <li data-reactid=".3.0.0.0.0.1.2"><a href="/accounts/edit/" data-reactid=".3.0.0.0.0.1.2.0">Edit
                                Profile</a></li>
                            <li data-reactid=".3.0.0.0.0.1.3"><a href="/accounts/badges/"
                                                                 data-reactid=".3.0.0.0.0.1.3.0">Badges</a></li>
                            <li data-reactid=".3.0.0.0.0.1.4"><a href="/accounts/logout/"
                                                                 data-reactid=".3.0.0.0.0.1.4.0">Log Out</a></li>
                        </ul>
                    </div>
                    <div class="rbSensor" data-reactid=".3.0.0.0.$sensor">
                        <iframe class="rbSensorFrame" data-reactid=".3.0.0.0.$sensor.0"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<link rel="stylesheet" href="__PUBLIC__/CSS/bootstrap.min.css">
<link rel="stylesheet" href="__PUBLIC__/CSS/bootstrap-theme.min.css">
<script src="__PUBLIC__/js/jquery-1.11.2.min.js"></script>
<script src="__PUBLIC__/js/bootstrap.min.js"></script>
<script type="text/javascript">
    $(".timelineCommentForm").on("submit", function () {
        var that = this;
        var comment = $(this).children().val();
        //var pid = $(this).parent().parent().parent().parent().parent().parent().data("userId");
        var pid = $(this).parents(".timelineItem").data("userId");
        $.ajax({
            type: 'post',
            url: "__URL__/submitComment",
            data: {'cm': comment, 'pid': pid}
        }).done(function () {
            username = $("strong").text();
            $(that).parents(".timelineCard").children(".timelineComments").children(".scrollArea").children(".scrollAreaContents").prepend("<div class='timelineComment'><a href='/" + username + "/'><div class='timelineCommentAvatar Image' src='http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg'><div class='iImage' id='iImage' style='background-image: url(http://nicksxs01.qiniudn.com/memory_anonymousUser.jpg)'></div></div></a><a href='/" + username + "/' class='timelineCommentUsername'>" + username + "</a><span class='timelineCommentText'><span>" + comment + "</span></span><a class='delete-comment'></a></div>");
            $(that).children().val("");
        });
        return false;
    });
    $(".timelineLikeButton").on("click", function () {
        var that = this;
        var pid = $(this).parents(".timelineItem").data("userId");
        if ($(that).hasClass("timelineLiked")) {
            $.ajax({
                type: 'post',
                url: "__URL__/submitLike",
                data: {'pid': pid, 'like': 'y'}
            }).done(function () {
                username = $("strong").text();
                $(that).removeClass("timelineLiked");
                tDom = $(that).parents(".timelineLikes").children(".timelineLikeList").children(".LikeList");
                tDom.find("a:eq(0)").remove();
                Lcount = tDom.find("span.llRemainingCount").text();
                Lcount = Lcount - 1;
                tDom.find("span.llRemainingCount").text(Lcount);
            })
        } else {
            $.ajax({
                type: 'post',
                url: "__URL__/submitLike",
                data: {'pid': pid, 'like': 'n'}
            }).done(function () {
                username = $("strong").text();
                $(that).addClass("timelineLiked");
                tDom = $(that).parents(".timelineLikes").children(".timelineLikeList").children(".LikeList");
                tDom.find("span:eq(0)").append("<a class='llNameLink'>" + username + "</a>");
                tDom.find("a:eq(2)").remove();
                Lcount = tDom.find("span.llRemainingCount").text() + 1;
                tDom.find("span.llRemainingCount").text(Lcount);
            })
        }

    })
    $("#_dropdownContext0").on("click", function () {
        // body...
        //$(".DropdownMenu").css('display', 'block');
        //$(".Dropdown").addClass('dOpen');
        $(".DropdownMenu").toggle();
        $(".Dropdown").toggleClass("dOpen");
    })
    // $(document).on("click", function () {
    //     // body...
    //     $(".DropdownMenu").toggle();
    //     $(".Dropdown").toggleClass("dOpen");
    // })
</script>
</body>
</html>